{
    "name": "Survey Auth",
    "namespace": "RUB\\SurveyAuthExternalModule",
    "description": "Adds authentication to surveys. <strong><a href=\"https://github.com/grezniczek/redcap_custom_footer\">See full documentation here</a></strong>.",
    "permissions": [
        "redcap_survey_page_top"
    ],
    "authors": [
        {
            "name": "Günther Rezniczek",
            "email": "guenther.rezniczek@rub.de",
            "institution": "Ruhr-Universität Bochum"
        }
    ],
    "system-settings": [
        {
            "key": "surveyauth_globaldebug",
            "name": "Global - Debug Mode",
            "type": "checkbox",
            "repeatable": false
        }
    ],
    "project-settings": [
        {
            "key": "surveyauth_log",
            "name": "Logging (default: All)",
            "type": "dropdown",
            "choices": [
                { "value": "none", "name": "None" },
                { "value": "fail", "name": "Failed attempts only" },
                { "value": "success", "name": "Successful attempts" },
                { "value": "all", "name": "All" }
            ],
            "super-users-only": true,
            "repeatable": false
        },
        {
            "key": "surveyauth_debug",
            "name": "Debug Mode",
            "type": "checkbox",
            "super-users-only": true,
            "repeatable": false
        },
        {
            "key": "surveyauth_token",
            "name": "API Token",
            "type": "textarea",
            "required": true,
            "repeatable": false
        },
        {
            "key": "surveyauth_text",
            "name": "Text displayed above username/password fields (default: 'Login is required to continue.')",
            "type": "textarea",
            "repeatable": false
        },
        {
            "key": "surveyauth_usernamelabel",
            "name": "Username label (default = 'Username')",
            "type": "text",
            "repeatable": false
        },
        {
            "key": "surveyauth_passwordlabel",
            "name": "Password label (default = 'Password')",
            "type": "text",
            "repeatable": false
        },
        {
            "key": "surveyauth_submitlabel",
            "name": "Submit label (default = 'Submit')",
            "type": "text",
            "repeatable": false
        },
        {
            "key": "surveyauth_failmsg",
            "name": "Fail message (default = 'Invalid username and/or password or access denied.')",
            "type": "textarea",
            "repeatable": false
        },
        {
            "key": "surveyauth_lockoutmsg",
            "name": "Lockout message (default = 'Too many failed login attempts. Please try again later.')",
            "type": "textarea",
            "repeatable": false
        },
        {
            "key": "surveyauth_lockouttime",
            "name": "Lockout time (minutes; default = 5 minutes)",
            "type": "text",
            "repeatable": false
        },
        {
            "key": "surveyauth_methodinfo",
            "name": "Select the authentication method(s) to use. <i>Table</i> means the REDCap table-based authentication method, <i>LDAP</i> means the LDAP configured in REDCap, <i>Other LDAP</i> let's you specify custom LDAP settings, <i>Custom</i> let's you set a list of username/password pairs. When multiple methods are active at the same time, the order of processing is: Custom &gt; Table &gt; Other LDAP &gt; LDAP. When no authentication method is used, all logins will fail.",
            "type": "descriptive"
        },
        {
            "key": "surveyauth_usetable",
            "name": "Table",
            "type": "checkbox"
        },
        {
            "key": "surveyauth_useldap",
            "name": "LDAP",
            "type": "checkbox"
        },
        {
            "key": "surveyauth_useotherldap",
            "name": "Other LDAP",
            "type": "checkbox"
        },
        {
            "key": "surveyauth_otherldap",
            "name": "LDAP Parameters (JSON, see docs)",
            "type": "json",
            "branchingLogic": {
                "field": "surveyauth_useotherldap",
                "op": "=",
                "value": true
            },
            "required": true
        },
        {
            "key": "surveyauth_usecustom",
            "name": "Custom",
            "type": "checkbox"
        },
        {
            "key": "surveyauth_custom",
            "name": "Custom Credentials (one set of credentials per line: username:password)",
            "type": "textarea",
            "branchingLogic": {
                "field": "surveyauth_usecustom",
                "op": "=",
                "value": true
            },
            "required": true
        },
        {
            "key": "surveyauth_whitelistinfo",
            "name": "Whitelisting can be activated. When active, only users in the whitelist can authenticate successfully. All others are denied (an empty whitelist has a deny-all-effect).",
            "type": "descriptive"
        },
        {
            "key": "surveyauth_usewhitelist",
            "name": "Use Whitelist",
            "type": "checkbox"
        },
        {
            "key": "surveyauth_whitelist",
            "name": "Whitelist (one username per line)",
            "type": "textarea",
            "branchingLogic": {
                "field": "surveyauth_usewhitelist",
                "op": "=",
                "value": true
            },
            "required": true
        }
    ],
    "no-auth-pages": [
        "authenticate"
    ],
    "compatibility": {
        "php-version-min": "5.4.0",
        "php-version-max": "",
        "redcap-version-min": "8.1.0",
        "redcap-version-max": ""
     }
}